'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

exports.default = function (req, res, salt) {
    var eAuth = req.headers('Authorization');
    var eUsername = eAuth.split(' ')[1];
    var username = new Packages.java.lang.String(Base64.getDecoder().decode(eUsername)).split(':')[0];
    return Jwts.builder().setSubject(username).signWith(SignatureAlgorithm.HS512, salt).compact();
};

/**
 * @author Pedro Sanders
 * @since v1
 */
var Jwts = Packages.io.jsonwebtoken.Jwts;
var SignatureAlgorithm = Packages.io.jsonwebtoken.SignatureAlgorithm;
var Base64 = Packages.java.util.Base64;